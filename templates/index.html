{% extends "base.html" %}
{% block content %}

<div class="grid gap-6 lg:grid-cols-[360px_1fr]">
  <!-- TOC -->
  <section class="rounded-3xl border border-slate-200 bg-white shadow-[0_12px_30px_rgba(2,6,23,0.08)]
                  dark:border-slate-800 dark:bg-slate-900/60">
    <div class="p-5 border-b border-slate-100 flex items-center justify-between dark:border-slate-800">
      <div class="leading-tight">
        <div class="text-[12px] tracking-wide text-slate-500 dark:text-slate-400">ФЕҲРИСТ</div>
        <div class="font-extrabold text-slate-900 dark:text-white">СИНФ <span class="text-indigo-500">{{ grade }}</span></div>
      </div>
      <div class="text-right">
        <div class="text-[11px] text-slate-400">ҲАМАШ</div>
        <div class="font-semibold text-slate-700 dark:text-slate-200">{{ total }} <span class="text-slate-400">дона</span></div>
      </div>
    </div>

    <div class="p-5 space-y-4">
      <!-- Search Topics + Wikipedia -->
      <div class="space-y-3">

        <!-- Topics search -->
        <div class="flex items-center gap-3 rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 shadow-inner
                    dark:border-slate-800 dark:bg-slate-950/40">
          <svg class="h-5 w-5 text-slate-400" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M10.5 19a8.5 8.5 0 1 1 0-17 8.5 8.5 0 0 1 0 17Z" stroke="currentColor" stroke-width="2"/>
            <path d="M16.8 16.8 21 21" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>

          <input name="q" type="search"
                 class="w-full bg-transparent text-slate-900 placeholder:text-slate-400 outline-none
                        dark:text-slate-100 dark:placeholder:text-slate-500"
                 placeholder="Ҷустуҷӯ дар феҳрист..."
                 hx-get="/partials/toc?grade={{grade}}"
                 hx-trigger="keyup changed delay:250ms"
                 hx-target="#toc"
                 hx-swap="innerHTML">
        </div>

        <!-- Wikipedia search -->
        <div class="flex items-center gap-3 rounded-2xl border border-slate-200 bg-white px-4 py-3 shadow-sm
                    dark:border-slate-800 dark:bg-slate-900/60">
          <svg class="h-5 w-5 text-slate-400" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M4 19V5a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v14" stroke="currentColor" stroke-width="2"/>
            <path d="M8 7h8M8 11h8M8 15h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>

          <input name="wq" type="search"
                 class="w-full bg-transparent text-slate-900 placeholder:text-slate-400 outline-none
                        dark:text-slate-100 dark:placeholder:text-slate-500"
                 placeholder="Ҷустуҷӯ аз Википедия..."
                 hx-get="/partials/wiki?lang=tg"
                 hx-trigger="keyup changed delay:400ms"
                 hx-target="#wiki_panel"
                 hx-swap="innerHTML">
        </div>

      </div>

      <!-- List -->
      <div id="toc" class="space-y-2">
        {% include "partials/toc.html" %}
      </div>

      <div class="pt-1 text-xs text-slate-400">
        Маслиҳат: номи мавзӯъро нависед, то зуд ёбед.
      </div>
    </div>
  </section>

  <!-- PAGE -->
  <section class="rounded-3xl border border-slate-200 bg-white shadow-[0_12px_30px_rgba(2,6,23,0.08)]
                  dark:border-slate-800 dark:bg-slate-900/60">
    <div class="p-5 border-b border-slate-100 dark:border-slate-800">
      <div class="text-[11px] uppercase tracking-widest text-slate-400">САҲИФА</div>
      <div class="font-bold text-slate-900 dark:text-white">Мавзӯъ ва шарҳ</div>
    </div>

    <div class="p-6 md:p-8">
      <!-- Wikipedia results appear here -->
      <div id="wiki_panel" class="mb-5"></div>

      {% if topic %}
        <div class="rounded-3xl border border-slate-200 bg-gradient-to-b from-white to-slate-50
                    shadow-[0_12px_28px_rgba(2,6,23,0.06)]
                    dark:border-slate-800 dark:from-slate-950/30 dark:to-slate-950/10">
          <div class="p-6 md:p-7">
            {% include "partials/topic_card.html" %}
          </div>
        </div>
      {% else %}
        <div class="rounded-3xl border border-dashed border-slate-300 bg-slate-50 p-10 text-center
                    dark:border-slate-700 dark:bg-slate-950/30">
          <div class="mx-auto mb-4 h-12 w-12 rounded-2xl bg-gradient-to-br from-indigo-500 to-fuchsia-500
                      shadow-[0_10px_22px_rgba(79,70,229,0.22)]"></div>
          <div class="text-slate-900 dark:text-white font-extrabold text-lg">Мавзӯъ интихоб нашудааст</div>
          <div class="mt-2 text-slate-500 dark:text-slate-300">
            Аз феҳрист як мавзӯъро интихоб кунед, то матн дар ин ҷо кушода шавад.
          </div>
        </div>
      {% endif %}
    </div>
  </section>
</div>

{% endblock %}
